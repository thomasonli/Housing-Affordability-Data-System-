---
title: "Capstone Project - Factors that Affect the Housing Affordability "
output: html_document
---

#Instructions

## THis document is to show how the data processes and transfromes, also
## how to apply the method and then analysis the data for the project 
## Factors that Affect the Housing Affordability 
## 


## LOAD data from the HADS website & load required R libraries
```{ r echo=TRUE}
install.packages("knitr")
library(knitr)
install.packages("rmarkdown")
library(rmarkdown)
install.packages("sas7bdat")
library(sas7bdat)

temp <- tempfile()
download.file("https://www.huduser.gov/portal/datasets/hads/hads2013n_ASCII.zip",temp)
hads2013n <- read.csv(unz(temp, "thads2013n.txt"), header = FALSE, skip = 1)
hads2013n.names <- readLines(unz(temp, "thads2013n.txt"), n = 1)
names(hads2013n) <- unlist(strsplit(hads2013n.names, ","))

```


### Check for attribute, Correlation using pearson for numeric variable or spearman for character variable
### and remove the attributes with more than lots of missing data 

## check attrible of the dataset and check for missing variable
## since control number is primary varible, there is no missing within
```{r echo=TRUE}
str(hads2013n)
```


## apply change for missing and error records and Duplicated Column
## notice by reading data description variable like BEDRMS and FMTBEDRMS are same but in different format
## and by comparing the unformated and formated the column, it shows formated columns are more reasonable
## to be used.
```{r echo=TRUE}
## check FMTOWNRENT and TENURE : 2 option, either Onwer or Renter
str(hads2013n$FMTOWNRENT)
str(hads2013n$TENURE)
table(hads2013n$FMTOWNRENT)
table(hads2013n$TENURE)
## Hence TENURE contains some error '-6'/missing rows. we will use FMTOWNRENT and Drop TENURE
hads2013n_c <- subset(hads2013n,select = -c(TENURE))
## check BEDRMS and FMTBEDRMS
str(hads2013n$BEDRMS)
str(hads2013n$FMTBEDRMS)
table(hads2013n$BEDRMS)
table(hads2013n$FMTBEDRMS)

## FMTBEDRMS is under sorted by group, drop BEDRMS
hads2013n_c <- subset(hads2013n_c,select = -c(BEDRMS))
 
## check ASSISTED & FMTASSISTED: 2 options not assisted or assisted.
str(hads2013n$ASSISTED)
str(hads2013n$FMTASSISTED)
table(hads2013n$ASSISTED)
table(hads2013n$FMTASSISTED)
## since test try to remove all missing rows from ASSISTED and notice all Owner is removed 
## we can say all assist is for renter only. we can remove both column ASSISTED & FMTASSISTED
hads2013n_c2 <- hads2013n[hads2013n$ASSISTED > -1,]
table(hads2013n$FMTASSISTED)
table(hads2013n_c2$FMTASSISTED)
table(hads2013n_c2$FMTOWNRENT)
rm(hads2013n_c2)
hads2013n_c <- subset(hads2013n_c,select = -c(ASSISTED, FMTASSISTED))

## REGION & FMTREGION :The four Census regions. Drop FMTREGION
str(hads2013n$REGION)
str(hads2013n$FMTREGION)
table(hads2013n$REGION)
table(hads2013n$FMTREGION)
hads2013n_c <- subset(hads2013n_c,select = -c(FMTREGION))

## METRO3 & FMTMETRO3 :indicate whether a unit is in a central city, suburb, or outside a 
## metropolitan area. Drop FMTMETRO3
str(hads2013n$METRO3)
str(hads2013n$FMTMETRO3)
table(hads2013n$METRO3)
table(hads2013n$FMTMETRO3)
hads2013n_c <- subset(hads2013n_c,select = -c(FMTMETRO3))

##COST06RELFMRCAT, FMTCOST06RELFMRCAT, COST06RELFMRPCT
str(hads2013n$COST06RELFMRCAT)
str(hads2013n$FMTCOST06RELFMRCAT)
str(hads2013n$COST06RELFMRPCT)
table(hads2013n$COST06RELFMRCAT)
table(hads2013n$FMTCOST06RELFMRCAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST06RELFMRCAT))

##COST06RELFMRCAT, FMTCOST06RELFMRCAT, COST06RELFMRPCT
##Cost06 Relative to FMR (Category), Cost06 Relative to FMR (Category), Cost06 Relative to FMR (Percent)

str(hads2013n$COST06RELFMRCAT)
str(hads2013n$FMTCOST06RELFMRCAT)
str(hads2013n$COST06RELFMRPCT)
table(hads2013n$COST06RELFMRCAT)
table(hads2013n$FMTCOST06RELFMRCAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST06RELFMRCAT))

##COST06RELAMICAT,FMTCOST06RELAMICAT, COST06RELAMIPCT
##Cost06 Relative to Median Income (Category), Cost06 Relative to Median Income (Category), 
##Cost06 Relative to Median Income (Percent)
## Drop COST06RELAMICAT
str(hads2013n$COST06RELAMICAT)
str(hads2013n$FMTCOST06RELAMICAT)
str(hads2013n$COST06RELFMRPCT)
table(hads2013n$COST06RELAMICAT)
table(hads2013n$FMTCOST06RELAMICAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST06RELAMICAT))

##COST06RELPOVCAT		Cost06 Relative to Poverty Income (Category)
##FMTCOST06RELPOVCAT		Cost06 Relative to Poverty Income (Category)
##COST06RELPOVPCT		Cost06 Relative to Poverty Income (Percent)
str(hads2013n$COST06RELPOVCAT)
str(hads2013n$FMTCOST06RELPOVCAT)
str(hads2013n$COST06RELPOVPCT)
table(hads2013n$COST06RELPOVCAT)
table(hads2013n$FMTCOST06RELPOVCAT)

##4438 missing at FMTCOST06RELPOVCAT, 6.88% of the rows to the entire dataset
## check the impact if we Remove the missing row
hads2013n_c2 <- hads2013n[hads2013n$COST06RELPOVCAT > 0,]
table(hads2013n_c2$COST06RELPOVCAT)
table(hads2013n_c2$FMTOWNRENT)
table(hads2013n$FMTOWNRENT)
## comparing the result owner drop from 37146 to 35852 and renter drop from 27389 to 24245
## so we dropp the missing rows and remove the testing dataset and the COST06RELPOVCAT column
rm(hads2013n_c2)
hads2013n_c <- hads2013n[hads2013n$COST06RELPOVCAT > 0,]
hads2013n_c <- subset(hads2013n_c,select = -c(COST06RELPOVCAT))


##SAME to all the following
#COST08RELFMRCAT	Cost08 Relative to FMR (Category)
#FMTCOST08RELFMRCAT	Cost08 Relative to FMR (Category)
#COST08RELFMRPCT	Cost08 Relative to FMR (Percent)
str(hads2013n_c$COST08RELFMRCAT)
str(hads2013n_c$FMTCOST08RELFMRCAT)
str(hads2013n_c$COST08RELFMRPCT)
table(hads2013n_c$COST08RELFMRCAT)
table(hads2013n_c$FMTCOST08RELFMRCAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST08RELFMRCAT))

##COST08RELAMICAT	Cost08 Relative to Median Income (Category)
##FMTCOST08RELAMICAT	Cost08 Relative to Median Income (Category)
##COST08RELAMIPCT	Cost08 Relative to Median Income (Percent)
str(hads2013n_c$COST08RELAMICAT)
str(hads2013n_c$FMTCOST08RELAMICAT)
str(hads2013n_c$COST08RELAMIPCT)
table(hads2013n_c$COST08RELAMICAT)
table(hads2013n_c$FMTCOST08RELAMICAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST08RELFMRCAT))

##COST08RELPOVCAT	Cost08 Relative to Poverty Income (Category)
##FMTCOST08RELPOVCAT	Cost08 Relative to Poverty Income (Category)
##COST08RELPOVPCT	Cost08 Relative to Poverty Income (Percent)
str(hads2013n_c$COST08RELPOVCAT)
str(hads2013n_c$FMTCOST08RELPOVCAT)
str(hads2013n_c$COST08RELPOVPCT)
table(hads2013n_c$COST08RELPOVCAT)
table(hads2013n_c$FMTCOST08RELPOVCAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST08RELPOVCAT))

##COST12RELFMRCAT	Cost12 Relative to FMR (Category)
##FMTCOST12RELFMRCAT	Cost12 Relative to FMR (Category)
##COST12RELFMRPCT	Cost12 Relative to FMR (Percent)
str(hads2013n_c$COST12RELFMRCAT)
str(hads2013n_c$FMTCOST12RELFMRCAT)
str(hads2013n_c$COST12RELFMRPCT)
table(hads2013n_c$COST12RELFMRCAT)
table(hads2013n_c$FMTCOST12RELFMRCAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST12RELFMRCAT))
##COST12RELAMICAT	Cost12 Relative to Median Income (Category)
##FMTCOST12RELAMICAT	Cost12 Relative to Median Income (Category)
##COST12RELAMIPCT	Cost12 Relative to Median Income (Percent)
str(hads2013n_c$COST12RELAMICAT)
str(hads2013n_c$FMTCOST12RELAMICAT)
str(hads2013n_c$COST12RELAMIPCT)
table(hads2013n_c$COST12RELAMICAT)
table(hads2013n_c$FMTCOST12RELAMICAT)
hads2013n_c <- subset(hads2013n_c,select = -c(COST12RELAMICAT))
##COST12RELPOVCAT	Cost12 Relative to Poverty Income (Category)
##FMTCOST12RELPOVCAT	Cost12 Relative to Poverty Income (Category)
##COST12RELPOVPCT	Cost12 Relative to Poverty Income (Percent)
##COSTMedRELFMRCAT	CostMed Relative to FMR (Category)
##FMTCOSTMEDRELFMRCAT	CostMed Relative to FMR (Category)
##COSTMedRELFMRPCT	CostMed Relative to FMR (Percent)
##COSTMedRELAMICAT	CostMed Relative to Median Income (Category)
##FMTCOSTMEDRELAMICAT	CostMed Relative to Median Income (Category)
##COSTMedRELAMIPCT	CostMed Relative to Median Income (Percent)
##COSTMedRELPOVCAT	CostMed Relative to Poverty Income (Category)
##FMTCOSTMEDRELPOVCAT	CostMed Relative to Poverty Income (Category)
##COSTMedRELPOVPCT	CostMed Relative to Poverty Income (Percent)




